<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lucky Draw - Home</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body{
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    color:#fff; min-height:100vh; padding:24px;
    display:flex; align-items:center; justify-content:center;
  }
  .container{
    width:100%; max-width:760px; background:rgba(255,255,255,0.07);
    padding:22px; border-radius:18px; box-shadow:0 10px 40px rgba(0,0,0,0.35);
    backdrop-filter: blur(6px);
  }

  .header{text-align:center;margin-bottom:18px}
  .header h1{font-size:2.4rem;margin-bottom:6px;text-shadow:0 4px 24px rgba(0,0,0,0.25)}
  .header p{opacity:.9}

  .layout{display:flex;gap:18px;flex-wrap:wrap;align-items:flex-start;justify-content:center}
  .left, .right{flex:1 1 320px;min-width:280px}

  /* Wheel (simple CSS circle with segments look) */
  .wheel-wrap{display:flex;flex-direction:column;align-items:center;gap:12px}
  .wheel{
    width:300px;height:300px;border-radius:50%;position:relative;overflow:hidden;
    background:conic-gradient(#ff6b6b 0 20%, #4ecdc4 20% 40%, #45b7d1 40% 60%, #96ceb4 60% 80%, #feca57 80% 100%);
    box-shadow:0 12px 40px rgba(0,0,0,0.45), inset 0 6px 20px rgba(255,255,255,0.03);
    display:flex;align-items:center;justify-content:center;transform:rotate(0deg);
  }
  .wheel-center{
    width:72px;height:72px;border-radius:50%;background:#ff6b6b;box-shadow:0 6px 24px rgba(255,107,107,0.35);
    display:flex;align-items:center;justify-content:center;font-weight:bold;
  }
  .pointer{
    width:42px;height:42px;background:#ff6b6b;clip-path:polygon(50% 0,0 100%,100% 100%);
    position:relative;top:-156px;left:0;transform:translateX(0);box-shadow:0 4px 12px rgba(0,0,0,.3);
    margin-bottom:-40px;
  }

  /* Gifts slider (horizontal auto-slide) */
  .gifts-wrap{margin-top:8px; width:100%; overflow:hidden; border-radius:12px; background:rgba(0,0,0,0.2); padding:10px}
  .gifts-track{display:flex; gap:18px; width:max-content; align-items:center; animation:slide 12s linear infinite}
  .gift{
    min-width:220px; padding:14px; border-radius:12px; background:rgba(255,255,255,0.06);
    display:flex;flex-direction:column;align-items:center;justify-content:center; text-align:center;
    box-shadow:0 6px 18px rgba(0,0,0,0.25);
  }
  .gift h3{font-size:1.05rem;margin-bottom:6px; font-weight:800; letter-spacing:.3px}
  .gift .emoji{font-size:28px;margin-bottom:6px}

  @keyframes slide{
    0% { transform: translateX(0); }
    20% { transform: translateX(0); }
    25% { transform: translateX(-240px); }
    45% { transform: translateX(-240px); }
    50% { transform: translateX(-480px); }
    70% { transform: translateX(-480px); }
    75% { transform: translateX(-720px); }
    95% { transform: translateX(-720px); }
    100% { transform: translateX(0); }
  }

  /* Leaderboard */
  .leaderboard{margin-top:8px;background:rgba(0,0,0,0.18);padding:12px;border-radius:12px}
  .leaderboard h4{margin-bottom:8px;text-align:center}
  .leaderboard ul{list-style:none;display:flex;flex-direction:column;gap:8px}
  .lb-item{display:flex;justify-content:space-between;padding:8px 10px;border-radius:8px;background:rgba(255,255,255,0.03);font-weight:700}

  /* CTA */
  .cta{margin-top:18px}
  .btn-primary{
    display:inline-block;padding:14px 20px;border-radius:12px;background:#ff6b6b;color:#fff;text-decoration:none;font-weight:800;
    box-shadow:0 8px 28px rgba(255,107,107,0.22);transition:transform .12s ease;
  }
  .btn-primary:active{transform:translateY(2px)}

  /* small notes */
  .note{margin-top:10px;font-size:.95rem;opacity:.95;text-align:center}

  /* responsive */
  @media (max-width:640px){
    .gifts-track{animation:slide 14s linear infinite}
    .wheel{width:260px;height:260px}
  }
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üéâ Lucky Draw</h1>
      <p>Spin the wheel ‚Äî real prizes, real verification.</p>
    </div>

    <div class="layout">
      <div class="left">
        <div class="wheel-wrap">
          <div class="pointer" aria-hidden="true"></div>
          <div class="wheel" id="home-wheel" role="img" aria-label="Prize wheel">
            <div class="wheel-center">SPIN</div>
          </div>

          <!-- Gifts horizontal auto-slide -->
          <div class="gifts-wrap" aria-hidden="false">
            <div class="gifts-track" id="gifts-track">
              <!-- gifts inserted by JS -->
            </div>
          </div>

          <div class="cta">
            <a class="btn-primary" id="participateBtn" href="participate_admin.html">Participate Now</a>
            <div class="note">Next draw: <strong id="next-draw-text">Today 8:00 PM</strong></div>
          </div>
        </div>
      </div>

      <div class="right">
        <div class="leaderboard">
          <h4>üèÜ Top Winners</h4>
          <ul id="home-leaderboard">
            <li class="lb-item">Loading‚Ä¶</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

  <script>
    // Firebase config (user-provided)
    const firebaseConfig = {
      apiKey: "AIzaSyC9XvQJohtUpZzgqunRgZngw5Akr2iNtGo",
      authDomain: "lucky-web-78c4f.firebaseapp.com",
      projectId: "lucky-web-78c4f",
      storageBucket: "lucky-web-78c4f.firebasestorage.app",
      messagingSenderId: "966619457091",
      appId: "1:966619457091:web:203193897b81de6eadd6f6"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Gifts data (matches prizes list)
    const gifts = [
      {title:'1st Prize ‚Äî iPhone', emoji:'üì±', color:'#ff6b6b'},
      {title:'2nd Prize ‚Äî 15k Cash', emoji:'üíµ', color:'#4ecdc4'},
      {title:'3rd Prize ‚Äî Laptop', emoji:'üíª', color:'#45b7d1'},
      {title:'4th Prize ‚Äî Dinner 5‚òÖ', emoji:'üçΩÔ∏è', color:'#96ceb4'},
      {title:'5th Prize ‚Äî 30k Gift', emoji:'üéÅ', color:'#feca57'}
    ];

    // render gifts into track
    function renderGifts(){
      const track = document.getElementById('gifts-track');
      track.innerHTML = '';
      // repeat items a bit so sliding feels long
      const repeated = [...gifts, ...gifts];
      repeated.forEach(g=>{
        const el = document.createElement('div');
        el.className = 'gift';
        el.innerHTML = `<div class="emoji">${g.emoji}</div><h3 style="color:${g.color}">${g.title}</h3>`;
        track.appendChild(el);
      });
    }

    // update countdown text simple (next day 8pm logic)
    function updateNextDrawText(){
      const now = new Date();
      const next = new Date();
      next.setDate(now.getDate() + 1);
      next.setHours(20,0,0,0);
      const opts = { month:'short', day:'numeric' };
      document.getElementById('next-draw-text').textContent = next.toLocaleDateString(undefined, opts) + ' 8:00 PM';
    }

    // leaderboard loading (approved)
    function loadHomeLeaderboard(){
      db.collection('participants').where('status','==','approved')
        .orderBy('tokens','desc').limit(5)
        .onSnapshot(snap=>{
          const ul = document.getElementById('home-leaderboard');
          ul.innerHTML = '';
          if(snap.empty){
            ul.innerHTML = '<li class="lb-item">No winners yet</li>';
            return;
          }
          snap.forEach((doc, idx)=>{
            const d = doc.data();
            const initials = (d.name || '‚Äî').split(' ').map(n=>n[0]||'').join('').toUpperCase();
            const li = document.createElement('li');
            li.className = 'lb-item';
            li.innerHTML = `<span>#${idx+1} ${initials}</span><span>${d.tokens||0} tokens</span>`;
            ul.appendChild(li);
          });
        }, err=>{ console.error('LB error',err) });
    }

    // init
    document.addEventListener('DOMContentLoaded', ()=>{
      renderGifts();
      updateNextDrawText();
      loadHomeLeaderboard();
    });
  </script>
</body>
</html>
